(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[819],{8447:(e,t,a)=>{Promise.resolve().then(a.bind(a,9876))},9876:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>i});var s=a(5155),l=a(2115),r=a(3464),n=a(5695);let c="http://localhost:5000/api";function i(){let e=(0,n.useRouter)(),[t,a]=(0,l.useState)([]),[i,o]=(0,l.useState)(!1),[d,m]=(0,l.useState)(""),[u,h]=(0,l.useState)(null),[x,p]=(0,l.useState)(""),[g,b]=(0,l.useState)(""),[j,N]=(0,l.useState)(""),[y,v]=(0,l.useState)(""),[f,k]=(0,l.useState)({}),[w,C]=(0,l.useState)(null),[D,S]=(0,l.useState)([]),[z,A]=(0,l.useState)(""),[_,B]=(0,l.useState)(null),[E,M]=(0,l.useState)(""),[L,O]=(0,l.useState)(""),q=()=>localStorage.getItem("token")||"";(0,l.useEffect)(()=>{G()},[]);let G=async()=>{o(!0),m("");try{let e=await r.A.get("".concat(c,"/customers"),{headers:{Authorization:"Bearer ".concat(q())}});a(e.data)}catch(e){console.error(e),m("M\xfcşteriler y\xfcklenemedi.")}finally{o(!1)}},T=()=>{p(""),b(""),N(""),v(""),h(null),k({}),m("")},V=()=>{let e={};return(!x.trim()||x.trim().length<2)&&(e.name="Ad en az 2 karakter olmalı."),g.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(g.trim())||(e.email="Ge\xe7erli bir email giriniz."):e.email="Email zorunludur.",j.trim()&&(/^[0-9]{10,15}$/.test(j.trim())||(e.phone="Telefon 10-15 rakam arasında olmalı ve sadece rakam i\xe7ermeli.")),y.split(",").map(e=>e.trim()).some(e=>0===e.length)&&(e.tags="Boş etiket olamaz."),k(e),0===Object.keys(e).length},Y=async e=>{if(e.preventDefault(),m(""),V())try{await r.A.post("".concat(c,"/customers"),{name:x,email:g,phone:j,tags:y.split(",").map(e=>e.trim()).filter(e=>e)},{headers:{Authorization:"Bearer ".concat(q())}}),T(),G()}catch(e){console.error(e),m("M\xfcşteri eklenemedi.")}},$=async e=>{if((e.preventDefault(),m(""),u)&&V())try{await r.A.put("".concat(c,"/customers/").concat(u._id),{name:x,email:g,phone:j,tags:y.split(",").map(e=>e.trim()).filter(e=>e)},{headers:{Authorization:"Bearer ".concat(q())}}),T(),G()}catch(e){console.error(e),m("M\xfcşteri g\xfcncellenemedi.")}},H=async e=>{m("");try{await r.A.delete("".concat(c,"/customers/").concat(e),{headers:{Authorization:"Bearer ".concat(q())}}),G()}catch(e){console.error(e),m("M\xfcşteri silinemedi.")}},I=async e=>{C(e),m("");try{let t=await r.A.get("".concat(c,"/customers/").concat(e._id),{headers:{Authorization:"Bearer ".concat(q())}});S(t.data.notes||[])}catch(e){console.error(e),S([]),m("Notlar y\xfcklenemedi.")}},K=async()=>{if(w&&z.trim()){m("");try{await r.A.post("".concat(c,"/customers/").concat(w._id,"/notes"),{text:z.trim()},{headers:{Authorization:"Bearer ".concat(q())}}),A(""),I(w)}catch(e){console.error(e),m("Not eklenemedi.")}}},P=async e=>{if(w){m("");try{await r.A.put("".concat(c,"/customers/").concat(w._id,"/notes/").concat(e),{text:E.trim()},{headers:{Authorization:"Bearer ".concat(q())}}),B(null),M(""),I(w)}catch(e){console.error(e),m("Not g\xfcncellenemedi.")}}},R=async e=>{if(w){m("");try{await r.A.delete("".concat(c,"/customers/").concat(w._id,"/notes/").concat(e),{headers:{Authorization:"Bearer ".concat(q())}}),I(w)}catch(e){console.error(e),m("Not silinemedi.")}}},F=e=>{h(e),p(e.name),b(e.email),N(e.phone),v(e.tags.join(", ")),k({}),m("")};return(0,s.jsxs)("div",{className:"p-6 max-w-4xl mx-auto",children:[(0,s.jsx)("div",{className:"mb-4",children:(0,s.jsx)("button",{onClick:()=>e.push("/dashboard"),className:"bg-gray-700 text-white px-4 py-2 rounded hover:bg-gray-800",children:"← Dashboard'a D\xf6n"})}),(0,s.jsx)("div",{className:"mb-4",children:(0,s.jsx)("input",{type:"text",placeholder:"İsim veya etiket ara...",value:L,onChange:e=>O(e.target.value),className:"border p-2 w-full"})}),(0,s.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"\uD83D\uDCCB M\xfcşteri Listesi"}),(0,s.jsxs)("form",{onSubmit:u?$:Y,className:"mb-6 space-y-2 border p-4 rounded",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("input",{className:"border p-2 w-full",placeholder:"Ad",value:x,onChange:e=>p(e.target.value),required:!0}),f.name&&(0,s.jsx)("p",{className:"text-red-600 text-sm mt-1",children:f.name})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("input",{className:"border p-2 w-full",placeholder:"Email",value:g,onChange:e=>b(e.target.value),type:"email",required:!0}),f.email&&(0,s.jsx)("p",{className:"text-red-600 text-sm mt-1",children:f.email})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("input",{className:"border p-2 w-full",placeholder:"Telefon",value:j,onChange:e=>N(e.target.value)}),f.phone&&(0,s.jsx)("p",{className:"text-red-600 text-sm mt-1",children:f.phone})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("input",{className:"border p-2 w-full",placeholder:"Etiketler (virg\xfclle)",value:y,onChange:e=>v(e.target.value)}),f.tags&&(0,s.jsx)("p",{className:"text-red-600 text-sm mt-1",children:f.tags})]})]}),(0,s.jsx)("button",{type:"submit",className:"px-4 py-2 rounded text-white ".concat(u?"bg-yellow-500":"bg-blue-600"),children:u?"\uD83D\uDCDD G\xfcncelle":"➕ M\xfcşteri Ekle"}),u&&(0,s.jsx)("button",{type:"button",onClick:T,className:"ml-2 px-4 py-2 rounded bg-gray-300",children:"Vazge\xe7"})]}),d&&(0,s.jsx)("p",{className:"text-red-600 mb-4",children:d}),i?(0,s.jsx)("p",{children:"Y\xfckleniyor..."}):0===t.length?(0,s.jsx)("p",{children:"Hen\xfcz m\xfcşteri yok."}):(0,s.jsx)("ul",{className:"space-y-4",children:t.filter(e=>{let t=L.toLowerCase();return e.name.toLowerCase().includes(t)||e.tags.some(e=>e.toLowerCase().includes(t))}).map(e=>(0,s.jsxs)("li",{className:"border p-4 rounded shadow",children:[(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:e.name})," - ",e.email," - ",e.phone]}),(0,s.jsxs)("p",{children:["Etiketler: ",(0,s.jsx)("span",{className:"text-sm text-gray-600",children:e.tags.join(", ")})]}),(0,s.jsxs)("div",{className:"mt-2 flex gap-2",children:[(0,s.jsx)("button",{onClick:()=>I(e),className:"text-blue-600 underline",children:"\uD83D\uDDD2 Notlar"}),(0,s.jsx)("button",{onClick:()=>F(e),className:"text-yellow-600 underline",children:"\uD83D\uDCDD D\xfczenle"}),(0,s.jsx)("button",{onClick:()=>H(e._id),className:"text-red-600 underline",children:"\uD83D\uDDD1 Sil"})]})]},e._id))}),w&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex justify-center items-center p-4 z-50",children:(0,s.jsxs)("div",{className:"bg-white p-6 rounded max-w-md w-full max-h-[80vh] overflow-y-auto relative",children:[(0,s.jsx)("button",{onClick:()=>{C(null),S([]),A(""),B(null),M(""),m("")},className:"absolute top-2 right-2 text-gray-600 hover:text-black",children:"✖"}),(0,s.jsxs)("h2",{className:"text-xl font-bold mb-4",children:["Notlar - ",w.name]}),(0,s.jsxs)("ul",{className:"mb-4 max-h-60 overflow-y-auto space-y-2",children:[0===D.length&&(0,s.jsx)("p",{children:"Not yok."}),D.map(e=>(0,s.jsx)("li",{className:"border-b pb-1",children:_===e._id?(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("input",{className:"border p-1 flex-grow",value:E,onChange:e=>M(e.target.value)}),(0,s.jsx)("button",{onClick:()=>P(e._id),className:"text-green-600",children:"Kaydet"}),(0,s.jsx)("button",{onClick:()=>{B(null),M("")},className:"text-gray-500",children:"Vazge\xe7"})]}):(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("span",{children:[new Date(e.date).toLocaleDateString()," - ",e.text]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("button",{onClick:()=>{B(e._id),M(e.text)},className:"text-blue-600 text-sm",children:"D\xfczenle"}),(0,s.jsx)("button",{onClick:()=>R(e._id),className:"text-red-600 text-sm",children:"Sil"})]})]})},e._id))]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("input",{value:z,onChange:e=>A(e.target.value),placeholder:"Yeni not...",className:"border p-2 flex-grow"}),(0,s.jsx)("button",{onClick:K,className:"bg-blue-600 text-white px-4 py-2 rounded",children:"Ekle"})]})]})})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[794,441,684,358],()=>t(8447)),_N_E=e.O()}]);